<!doctype html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="description" content="Geeks Note for Embedded System"/>
        <meta name="keywords" content="OpenWRT,GoPro,Mobius ActionCam,Flytecam,SSD"/>
        <meta name="author" content="Edgar1470"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <title>Geeks Note - .MOV内嵌GPS信息分析之二
</title>
        <link rel="stylesheet" href="/assets/vendor/normalize.css"/>
        <link rel="stylesheet" href="/assets/vendor/prettify-night.css"/>
        <link rel="stylesheet" href="/assets/themes/default/main.css"/>
        <link rel="shortcut icon" href="/fav.ico"/>
        <script type="text/javascript" src="/assets/vendor/prettify.js"></script>
        
    </head>
    <body onload="prettyPrint()">
    <div id="header">
        <div id="header-inner">
            <div id="title"><a href="/">Geeks Note</a></div>
            <div id="subtitle">Open your heart &amp; Enjoy the life course</div>
        </div>
    </div>

<div id="main">
    <div id="main-inner">
        <div id="topnav">
            <ul>
                <li><a href="/">首页</a></li>
                <li class="sep"> | </li>
                <li><a href="/tag.html">标签</a></li>
                
<li class="sep"> | </li>
<li><a href="/pages/about-me.html" target="_self">关于我</a></li>

<li class="sep"> | </li>
<li><a href="https://github.com/edgar1470" target="_blank">Github</a></li>

<li class="sep"> | </li>
<li><a href="http://edgar1470.github.io/rss.xml" target="_blank">RSS</a></li>


            </ul>
            <div style="clear:both;"></div>
        </div>
        <div id="article-title">
            <a href="/articles/mov-fileformat-002.html">.MOV内嵌GPS信息分析之二</a>
        </div>
        <div id="article-meta">
            作者 edgar1470 | 发布于 2014-01-10 11:31:52
        </div>
        <div id="article-tags">
        
        <a class="tag" href="/tag.html#mov">mov</a>
        
        <a class="tag" href="/tag.html#gps">gps</a>
        
        <a class="tag" href="/tag.html#nt96650">nt96650</a>
        
        <a class="tag" href="/tag.html#ntk">ntk</a>
        
        <a class="tag" href="/tag.html#novatek">novatek</a>
        
        <a class="tag" href="/tag.html#联咏">联咏</a>
        
        </div>
        <div id="article-content">
            <h3 id="mov-gps-">MOV内嵌GPS信息分析之二</h3>
<ul>
<li><a href="#root-atom">顶层ATOM</a></li>
<li><a href="#root-ftyp">ATOM: ftyp</a></li>
<li><a href="#root-frea">ATOM: frea</a></li>
<li><a href="#root-mdat">ATOM: mdat</a></li>
<li><a href="#root-moov">ATOM: moov</a> </li>
</ul>
<p><a name="root-atom"> 顶层ATOM</a><br>以文件<strong>REC_0001_GPS_FAKE.MOV</strong>为例:<br>文件大小(字节) : 17894846  = 0x1110DBE   </p>
<ul>
<li>ftyp  长度 = 0x00000018</li>
<li>frea  长度 = 0x0000747c</li>
<li>mdat  长度 = 0x01108b74 </li>
<li>moov  长度 = 0x00000db6 </li>
</ul>
<p><a name="root-ftyp"> ATOM: ftyp</a></p>
<pre class="prettyprint linenums lang-shell">edgar@debian:/data_disk/github/edgar1470.github.io/articles/qtff$ xxd -g4 -c4 -l 0x18 REC_0001_GPS_FAKE.MOV 
0000000: 00000018  ....    Size         ftyp的长度 0x18字节
0000004: 66747970  ftyp    Type         ftyp的ATOM标记
0000008: 71742020  qt      Major_Brand  QuickTime movie file
000000c: 00000000  ....    Minor_Version
0000010: 71742020  qt      Compatible_Brands 
0000014: 00000000  ....
</pre>
<p><a name="root-frea"> ATOM: frea</a></p>
<pre class="prettyprint linenums lang-shell">edgar@debian:/data_disk/github/edgar1470.github.io/articles/qtff$ xxd -g4 -c4 -s 0x18 -l 100 REC_0001_GPS_FAKE.MOV 
0000018: 0000747c  ..t| Size  frea的长度 0x747C
000001c: 66726561  frea Type  frea的ATOM标记
0000020: 0000000c  ....   Size tima的长度 0x0C      
0000024: 74696d61  tima   Type tima的ATOM标记
0000028: 00000009  ....   Unknown
000002c: 00001be4  ....     Size thma的长度 0x1BE4
0000030: 74686d61  thma     Type thma
0000034: ffd8ffdb  ....       FFD8  JPG?
0000038: 00840006  ....
000003c: 04050605  ....
....
</pre>
<p>真的是 JPG?
FFD8  FFD9  好熟悉哈</p>
<pre class="prettyprint linenums lang-shell">edgar@debian:/data_disk/github/edgar1470.github.io/articles/qtff$ xxd -u -g4 -c4 -s 0x34 -l 0x1BDC REC_0001_GPS_FAKE.MOV 
0000034: FFD8FFDB  ....
0000038: 00840006  ....
000003c: 04050605  ....
0000040: 04060605  ....
0000044: 06070706  ....
....
0001bf8: 45140051  E..Q
0001bfc: 45140051  E..Q
0001c00: 45140051  E..Q
0001c04: 45140051  E..Q
0001c08: 451401FF  E...
0001c0c: D9FFFFFF  ....
edgar@debian:/data_disk/github/edgar1470.github.io/articles/qtff$ dd skip=52 count=7132 if=REC_0001_GPS_FAKE.MOV of=thma.jpg bs=1
7132+0 records in
7132+0 records out
7132 bytes (7.1 kB) copied, 0.0176471 s, 404 kB/s
</pre>
<p>打开thma.jpg真的是一张320x240的缩略图   </p>
<p>frea的ATOM内存放了两张缩略图:</p>
<ul>
<li>一张320x240大小  </li>
<li>一张640x480大小<pre class="prettyprint linenums lang-shell">edgar@debian:/data_disk/github/edgar1470.github.io/articles/qtff$ xxd -u -g4 -c4 -s 0x18 -l 0x1BDC REC_0001_GPS_FAKE.MOV 
0000018: 0000747C  ..t|
000001c: 66726561  frea
0000020: 0000000C  ....
0000024: 74696D61  tima
0000028: 00000009  ....
000002c: 00001BE4  ....
0000030: 74686D61  thma   &lt;- 第一张缩略图 
0000034: FFD8FFDB  ....
0000038: 00840006  ....
....
0001c08: 451401FF  E...
0001c0c: D9FFFFFF  ....
0001c10: 00005884  ..X.
0001c14: 73637261  scra   &lt;- 第二张缩略图
0001c18: FFD8FFDB  ....
0001c1c: 00840006  ....
0001c20: 04050605  ....
....
000748c: 00514514  .QE.
0007490: 01FFD900  ....
0007494: 01108B74  ...t
0007498: 6D646174  mdat
000749c: 00000000  ....
00074a0: 00000000  ....
....
1110000: 8ADB9742  ...B
1110004: 5F16F14C  _..L
1110008: 00000DB6  ....
111000c: 6D6F6F76  moov
1110010: 0000006C  ...l
1110014: 6D766864  mvhd
1110018: 00000000  ....
111001c: CD07D7D4  ....
1110020: CD07D7D4  ....
1110024: 00007530  ..u0
1110028: 00041EB0  ....
111002c: 00010000  ....
1110030: 01000000  ....
1110034: 00000000  ....
1110038: 00000000  ....
</pre>
</li>
</ul>
<p><a name="root-mdat"> ATOM: mdat</a>  </p>
<p><a name="root-moov"> ATOM: moov</a><br>QuickTime movie atoms have an atom type of &#39;moov&#39;. These atoms act as a container for the information that describes a movie’s data. This information, or metadata, is stored in a number of different types of atoms. Generally speaking, only metadata is stored in a movie atom. Sample data for the movie, such as audio or video samples, are referenced in the movie atom, but are not contained in it.</p>
<pre class="prettyprint linenums lang-shell">1110008: 00000DB6  ....     --&gt;1110DBE  EOF
111000c: 6D6F6F76  moov
1110010: 0000006C  ...l     --&gt;111007C
1110014: 6D766864  mvhd
1110018: 00000000  ....
....      
111007c: 00000AD6  ....     --&gt;1110B52
1110080: 7472616B  trak                       
1110b52: 00000239  ...9     --&gt;1110D8B
1110b56: 7472616B  trak
....
1110d8b: 00000033  ...3       --&gt;1110DBE  EOF
1110d8f: 75647461  udta
1110d93: 00000013  ....       --&gt;1110DA6      
1110d97: A9666D74  .fmt
...
1110da6: 00000018  ....     --&gt;1110DBE  EOF
1110daa: A9696E66  .inf
1110dae: 000C0000  ....
1110db2: 48444456  HDDV
1110db6: 522D3130  R-10
1110dba: 38305000  80P.
1110DBE  EOF
</pre>

        </div>
        
    </div>
</div>
        <div id="footer">
            <div id="footer-inner">
                <p id="copyright">
                Powered By <a href="https://github.com/ericzhang-cn/papery">papery</a>   Copyright &copy; 2014-2014 Edgar1470
                </p>
            </div>
        </div>
         <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>

    </body>
</html>

